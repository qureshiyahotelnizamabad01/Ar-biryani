<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Biryani AR â€” Fixed UI</title>

<script type="module"
  src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
</script>

<style>
html,body{
  margin:0;
  height:100%;
  background:#000;
  font-family:system-ui,Arial;
}

/* CAMERA */
#camVideo{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:0;
}

/* MODEL VIEWER */
model-viewer{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  background:transparent;
  z-index:1;
  pointer-events:none; /* ðŸ”‘ critical */
}

/* UI BAR */
#ui{
  position:fixed;
  top:12px;
  left:12px;
  display:flex;
  gap:8px;
  background:rgba(0,0,0,.6);
  padding:8px;
  border-radius:10px;
  z-index:5;
  pointer-events:auto;
}

select,button{
  padding:10px 14px;
  font-size:14px;
  border-radius:10px;
  border:none;
}

button{
  background:#e53935;
  color:white;
  font-weight:600;
}

/* OVERLAY */
#overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.7);
  z-index:10;
  pointer-events:auto;
}

#overlay.hidden{
  display:none !important;
  pointer-events:none !important;
}

/* STATUS */
#status{
  position:fixed;
  bottom:12px;
  left:12px;
  background:rgba(0,0,0,.6);
  color:white;
  padding:8px 10px;
  border-radius:8px;
  font-size:13px;
  z-index:6;
}
</style>
</head>

<body>

<video id="camVideo" autoplay playsinline muted></video>

<model-viewer
  src="textured.glb"
  ar
  ar-modes="webxr scene-viewer"
  ar-placement="floor">
</model-viewer>

<div id="ui" hidden>
  <button id="switchBtn">Switch Camera</button>
  <button id="stopBtn" style="background:#555">Stop</button>
</div>

<div id="overlay">
  <div style="text-align:center;color:white">
    <h2>View this item in AR</h2>
    <p>Tap to allow camera access</p>
    <button id="startBtn" style="font-size:18px">ðŸ“¸ Start Camera</button>
  </div>
</div>

<div id="status"></div>

<script>
const video = document.getElementById('camVideo');
const overlay = document.getElementById('overlay');
const ui = document.getElementById('ui');
const status = document.getElementById('status');
let stream;
let facing = "environment";

function log(msg){ status.textContent = msg; }

async function startCamera(){
  if(stream){
    stream.getTracks().forEach(t=>t.stop());
  }
  stream = await navigator.mediaDevices.getUserMedia({
    video:{ facingMode: facing }
  });
  video.srcObject = stream;
  await video.play();
  overlay.classList.add("hidden");
  ui.hidden = false;
  log("Camera started");
}

document.getElementById('startBtn').onclick = async ()=>{
  try{
    await startCamera();
  }catch(e){
    log("Camera error");
  }
};

document.getElementById('switchBtn').onclick = async ()=>{
  facing = facing === "environment" ? "user" : "environment";
  await startCamera();
};

document.getElementById('stopBtn').onclick = ()=>{
  stream.getTracks().forEach(t=>t.stop());
  ui.hidden = true;
  overlay.classList.remove("hidden");
};
</script>

</body>
</html>
